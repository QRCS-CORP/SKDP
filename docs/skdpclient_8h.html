<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SKDP: Symmetric Key Distribution Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/SKDP/SKDP/skdpclient.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="skdp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SKDP: Symmetric Key Distribution Protocol<span id="projectnumber">&#160;1.1.0.0 (A1)</span>
   </div>
   <div id="projectbrief">Encrypted tunneling protocol using pre-shared keys</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('skdpclient_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">skdpclient.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The SKDP client.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;common.h&quot;</code><br />
<code>#include &quot;<a class="el" href="skdp_8h_source.html">skdp.h</a>&quot;</code><br />
<code>#include &quot;../../QSC/QSC/rcs.h&quot;</code><br />
<code>#include &quot;../../QSC/QSC/socketclient.h&quot;</code><br />
</div>
<p><a href="skdpclient_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structskdp__client__state.html">skdp_client_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SKDP client state structure.  <a href="structskdp__client__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae7edcc108f384681a2e4b3c418a3d1b7" id="r_ae7edcc108f384681a2e4b3c418a3d1b7"><td class="memItemLeft" align="right" valign="top"><a id="ae7edcc108f384681a2e4b3c418a3d1b7" name="ae7edcc108f384681a2e4b3c418a3d1b7"></a>
typedef SKDP_EXPORT_API struct skdp_client_state&#160;</td><td class="memItemRight" valign="bottom"><b>skdp_client_state</b></td></tr>
<tr class="separator:ae7edcc108f384681a2e4b3c418a3d1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a525c0c0515cb03109fbe890751856a02" id="r_a525c0c0515cb03109fbe890751856a02"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a525c0c0515cb03109fbe890751856a02">skdp_client_send_error</a> (const qsc_socket *sock, <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> error)</td></tr>
<tr class="memdesc:a525c0c0515cb03109fbe890751856a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an error code to the remote host.  <br /></td></tr>
<tr class="separator:a525c0c0515cb03109fbe890751856a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08266594611cf8a3195eef1a14ddde82" id="r_a08266594611cf8a3195eef1a14ddde82"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08266594611cf8a3195eef1a14ddde82">skdp_client_initialize</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, const <a class="el" href="structskdp__device__key.html">skdp_device_key</a> *ckey)</td></tr>
<tr class="memdesc:a08266594611cf8a3195eef1a14ddde82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the SKDP client state.  <br /></td></tr>
<tr class="separator:a08266594611cf8a3195eef1a14ddde82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c1af3938b4c5376622299d63e70d77" id="r_a92c1af3938b4c5376622299d63e70d77"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92c1af3938b4c5376622299d63e70d77">skdp_client_connect_ipv4</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, qsc_socket *sock, const qsc_ipinfo_ipv4_address *address, uint16_t port)</td></tr>
<tr class="memdesc:a92c1af3938b4c5376622299d63e70d77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish an IPv4 connection and perform the SKDP key exchange.  <br /></td></tr>
<tr class="separator:a92c1af3938b4c5376622299d63e70d77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2271486651c983779ab73980150ce9d9" id="r_a2271486651c983779ab73980150ce9d9"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2271486651c983779ab73980150ce9d9">skdp_client_connect_ipv6</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, qsc_socket *sock, const qsc_ipinfo_ipv6_address *address, uint16_t port)</td></tr>
<tr class="memdesc:a2271486651c983779ab73980150ce9d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish an IPv6 connection and perform the SKDP key exchange.  <br /></td></tr>
<tr class="separator:a2271486651c983779ab73980150ce9d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5bd1b2e4b58521b928a006b7c93c9e9" id="r_ae5bd1b2e4b58521b928a006b7c93c9e9"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5bd1b2e4b58521b928a006b7c93c9e9">skdp_client_connection_close</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, qsc_socket *sock, <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> error)</td></tr>
<tr class="memdesc:ae5bd1b2e4b58521b928a006b7c93c9e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the remote session and dispose of client resources.  <br /></td></tr>
<tr class="separator:ae5bd1b2e4b58521b928a006b7c93c9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a178adc65bfe39dc911d31e2eb120cef3" id="r_a178adc65bfe39dc911d31e2eb120cef3"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a178adc65bfe39dc911d31e2eb120cef3">skdp_client_decrypt_packet</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, const <a class="el" href="structskdp__network__packet.html">skdp_network_packet</a> *packetin, uint8_t *message, size_t *msglen)</td></tr>
<tr class="memdesc:a178adc65bfe39dc911d31e2eb120cef3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt an SKDP packet.  <br /></td></tr>
<tr class="separator:a178adc65bfe39dc911d31e2eb120cef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd41b8b2421b3e99031ce4720e21f3b" id="r_a8cd41b8b2421b3e99031ce4720e21f3b"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8cd41b8b2421b3e99031ce4720e21f3b">skdp_client_encrypt_packet</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, const uint8_t *message, size_t msglen, <a class="el" href="structskdp__network__packet.html">skdp_network_packet</a> *packetout)</td></tr>
<tr class="memdesc:a8cd41b8b2421b3e99031ce4720e21f3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a message into an SKDP packet.  <br /></td></tr>
<tr class="separator:a8cd41b8b2421b3e99031ce4720e21f3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a340670c8156a1bc756f4e1db0007cdeb" id="r_a340670c8156a1bc756f4e1db0007cdeb"><td class="memItemLeft" align="right" valign="top">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a340670c8156a1bc756f4e1db0007cdeb">skdp_client_ratchet_request</a> (<a class="el" href="structskdp__client__state.html">skdp_client_state</a> *ctx, <a class="el" href="structskdp__network__packet.html">skdp_network_packet</a> *packetout)</td></tr>
<tr class="memdesc:a340670c8156a1bc756f4e1db0007cdeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a ratchet request to the server.  <br /></td></tr>
<tr class="separator:a340670c8156a1bc756f4e1db0007cdeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The SKDP client. </p>
<p>This header defines the client-side functions and state structures for the Symmetric Key Distribution Protocol (SKDP). The SKDP client is responsible for initiating secure key exchange sessions with an SKDP server, managing encryption and decryption of messages, and handling key ratcheting to provide forward secrecy. It supports network connections over both IPv4 and IPv6.</p>
<p>The key exchange process in SKDP involves several stages, including connection, exchange, establish, and ratchet operations. In each phase, ephemeral keys are derived from pre-shared keys so that even if a device's embedded key is compromised, past communications remain secure.</p>
<dl class="section note"><dt>Note</dt><dd>All functions and structures defined in this header are part of the internal client implementation. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a92c1af3938b4c5376622299d63e70d77" name="a92c1af3938b4c5376622299d63e70d77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c1af3938b4c5376622299d63e70d77">&#9670;&#160;</a></span>skdp_client_connect_ipv4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> skdp_client_connect_ipv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const qsc_ipinfo_ipv4_address *</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish an IPv4 connection and perform the SKDP key exchange. </p>
<p>This function connects to an SKDP server over IPv4 and performs the key exchange protocol. It updates the client state with session parameters including cipher states and sequence numbers, and returns the connected socket via the provided socket pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure. </td></tr>
    <tr><td class="paramname">sock</td><td>A pointer to the socket structure which will be connected. </td></tr>
    <tr><td class="paramname">address</td><td>A pointer to the server's IPv4 network address. </td></tr>
    <tr><td class="paramname">port</td><td>The server's port number.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b" title="The SKDP error values.">skdp_errors</a></code> indicating the success or failure of the connection and key exchange process. </dd></dl>

</div>
</div>
<a id="a2271486651c983779ab73980150ce9d9" name="a2271486651c983779ab73980150ce9d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2271486651c983779ab73980150ce9d9">&#9670;&#160;</a></span>skdp_client_connect_ipv6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> skdp_client_connect_ipv6 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const qsc_ipinfo_ipv6_address *</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish an IPv6 connection and perform the SKDP key exchange. </p>
<p>This function connects to an SKDP server over IPv6 and executes the key exchange protocol. It updates the client state with the negotiated session parameters and returns the connected socket through the provided pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure. </td></tr>
    <tr><td class="paramname">sock</td><td>A pointer to the socket structure which will be connected. </td></tr>
    <tr><td class="paramname">address</td><td>A pointer to the server's IPv6 network address. </td></tr>
    <tr><td class="paramname">port</td><td>The server's port number.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b" title="The SKDP error values.">skdp_errors</a></code> representing the outcome of the connection and key exchange. </dd></dl>

</div>
</div>
<a id="ae5bd1b2e4b58521b928a006b7c93c9e9" name="ae5bd1b2e4b58521b928a006b7c93c9e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5bd1b2e4b58521b928a006b7c93c9e9">&#9670;&#160;</a></span>skdp_client_connection_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API void skdp_client_connection_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the remote session and dispose of client resources. </p>
<p>This function closes the SKDP client session by sending an error notification (if necessary) to the remote host, and then disposing of the client state and releasing the associated socket resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure. </td></tr>
    <tr><td class="paramname">sock</td><td>A pointer to the initialized socket structure. </td></tr>
    <tr><td class="paramname">error</td><td>The SKDP error code indicating the reason for closing the session. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a178adc65bfe39dc911d31e2eb120cef3" name="a178adc65bfe39dc911d31e2eb120cef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a178adc65bfe39dc911d31e2eb120cef3">&#9670;&#160;</a></span>skdp_client_decrypt_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> skdp_client_decrypt_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structskdp__network__packet.html">skdp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt an SKDP packet. </p>
<p>This function decrypts the message contained in the input SKDP network packet using the client's current decryption state, and copies the plaintext into the provided output buffer. The length of the decrypted message is returned via the msglen parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure. </td></tr>
    <tr><td class="paramname">packetin</td><td>[const] A pointer to the input SKDP network packet. </td></tr>
    <tr><td class="paramname">message</td><td>The output buffer where the decrypted message will be stored. </td></tr>
    <tr><td class="paramname">msglen</td><td>A pointer to a variable that receives the length of the decrypted message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b" title="The SKDP error values.">skdp_errors</a></code> indicating the result of the decryption operation. </dd></dl>

</div>
</div>
<a id="a8cd41b8b2421b3e99031ce4720e21f3b" name="a8cd41b8b2421b3e99031ce4720e21f3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd41b8b2421b3e99031ce4720e21f3b">&#9670;&#160;</a></span>skdp_client_encrypt_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> skdp_client_encrypt_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structskdp__network__packet.html">skdp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetout</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a message into an SKDP packet. </p>
<p>This function encrypts the provided plaintext message using the client's current transmit cipher state. It then constructs an SKDP network packet containing the encrypted message along with the appropriate header fields (such as message length, sequence number, and UTC timestamp), and outputs the packet via the provided structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure. </td></tr>
    <tr><td class="paramname">message</td><td>[const] The plaintext message to be encrypted. </td></tr>
    <tr><td class="paramname">msglen</td><td>The length of the plaintext message in bytes. </td></tr>
    <tr><td class="paramname">packetout</td><td>A pointer to the output SKDP network packet structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b" title="The SKDP error values.">skdp_errors</a></code> indicating the success or failure of the encryption process. </dd></dl>

</div>
</div>
<a id="a08266594611cf8a3195eef1a14ddde82" name="a08266594611cf8a3195eef1a14ddde82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08266594611cf8a3195eef1a14ddde82">&#9670;&#160;</a></span>skdp_client_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API void skdp_client_initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structskdp__device__key.html">skdp_device_key</a> *</td>          <td class="paramname"><span class="paramname"><em>ckey</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the SKDP client state. </p>
<p>This function initializes the SKDP client state structure by configuring the cipher states and copying the client's device key information. The device key, which includes the device derivation key and identity, is used to derive the session keys for encryption and decryption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure to be initialized. </td></tr>
    <tr><td class="paramname">ckey</td><td>A pointer to the SKDP device key structure containing the client's key information. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a340670c8156a1bc756f4e1db0007cdeb" name="a340670c8156a1bc756f4e1db0007cdeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a340670c8156a1bc756f4e1db0007cdeb">&#9670;&#160;</a></span>skdp_client_ratchet_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API <a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a> skdp_client_ratchet_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structskdp__client__state.html">skdp_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structskdp__network__packet.html">skdp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetout</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a ratchet request to the server. </p>
<p>In SKDP, a ratchet request is used to ask the server for a new token key on demand. This mechanism is useful in static tunnel configurations to periodically inject additional entropy into the system based on uptime or data transferred. The function constructs a ratchet request packet using the current client state and sends it to the server.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A pointer to the SKDP client state structure. </td></tr>
    <tr><td class="paramname">packetout</td><td>A pointer to the output SKDP network packet structure that will contain the ratchet request.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b" title="The SKDP error values.">skdp_errors</a></code> indicating the outcome of the ratchet request operation. </dd></dl>

</div>
</div>
<a id="a525c0c0515cb03109fbe890751856a02" name="a525c0c0515cb03109fbe890751856a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525c0c0515cb03109fbe890751856a02">&#9670;&#160;</a></span>skdp_client_send_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SKDP_EXPORT_API void skdp_client_send_error </td>
          <td>(</td>
          <td class="paramtype">const qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="skdp_8h.html#a941c4d5a2c383c51c315a3b65d7ab91b">skdp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an error code to the remote host. </p>
<p>This function transmits an SKDP error code over the specified socket, thereby informing the remote host of an error condition encountered during communication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>A pointer to the initialized socket structure. </td></tr>
    <tr><td class="paramname">error</td><td>The SKDP error code to be sent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_11a2b35b32cf64f0531b234e6700c197.html">SKDP</a></li><li class="navelem"><a class="el" href="skdpclient_8h.html">skdpclient.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
